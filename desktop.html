<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>桌面</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            user-select: none;
        }
        
        body {
            background-color: #000;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }
        
        /* 桌面背景 - 随机生成 */
        .desktop-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - 40px);
            background-color: #0078d4;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }
        
        /* 桌面图标容器 */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            z-index: 5;
        }
        
        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80px;
            cursor: pointer;
            transition: all 0.2s;
            padding: 10px;
            border-radius: 5px;
        }
        
        .desktop-icon:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .icon-img {
            width: 48px;
            height: 48px;
            margin-bottom: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 36px;
            color: white;
        }
        
        .icon-label {
            color: white;
            font-size: 12px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        /* 状态栏 */
        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background-color: rgba(32, 32, 32, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 100;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* 开始菜单/电源按钮 */
        .start-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-right: 20px;
            position: relative;
        }
        
        .power-btn {
            width: 36px;
            height: 36px;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            font-size: 18px;
        }
        
        .power-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .shutdown-menu {
            position: absolute;
            bottom: 45px;
            left: 0;
            background-color: rgba(32, 32, 32, 0.95);
            border-radius: 5px;
            padding: 10px 0;
            min-width: 180px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 101;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .shutdown-menu.show {
            display: block;
        }
        
        .shutdown-option {
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .shutdown-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        /* 系统托盘 */
        .system-tray {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-right: 10px;
            color: white;
        }
        
        .tray-icon {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }
        
        .tray-icon i {
            font-size: 16px;
        }
        
        .time-display {
            font-size: 14px;
            letter-spacing: 0.5px;
        }
        
        /* 电源确认对话框 */
        .shutdown-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .shutdown-dialog.show {
            display: flex;
        }
        
        .dialog-content {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .dialog-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .dialog-text {
            margin-bottom: 25px;
            color: #666;
            line-height: 1.5;
        }
        
        .dialog-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .dialog-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            min-width: 100px;
        }
        
        .dialog-btn.confirm {
            background-color: #0078d4;
            color: white;
        }
        
        .dialog-btn.cancel {
            background-color: #f0f0f0;
            color: #333;
        }
        
        /* 应用窗口 - 居中显示 */
        .app-window {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 700px;
            height: 500px;
            background-color: rgba(240, 240, 240, 0.95);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
            flex-direction: column;
            z-index: 10;
            border: 1px solid #ddd;
            overflow: hidden;
        }
        
        .app-window.active {
            display: flex;
        }
        
        .app-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            background-color: #f5f5f5;
        }
        
        .app-window-title {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .app-window-controls {
            display: flex;
            gap: 8px;
        }
        
        .window-control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .window-control-btn.close {
            background-color: #ff5f57;
        }
        
        .window-control-btn.minimize {
            background-color: #ffbd2e;
        }
        
        .window-control-btn.maximize {
            background-color: #28ca42;
        }
        
        .app-window-content {
            flex: 1;
            color: #666;
            display: flex;
            flex-direction: column;
            overflow: auto;
            padding: 20px;
        }
        
        /* 文件夹样式 - 模拟苹果风格 */
        .folder-window {
            width: 800px;
            height: 550px;
        }
        
        .folder-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .folder-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 15px 10px;
            border-radius: 8px;
            transition: all 0.2s;
            width: 120px;
            height: 120px;
            position: relative;
        }
        
        .folder-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .folder-item:hover::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            pointer-events: none;
        }
        
        .folder-icon {
            width: 64px;
            height: 64px;
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 48px;
        }
        
        .folder-item-name {
            font-size: 13px;
            color: #333;
            text-align: center;
            word-break: break-word;
            max-width: 100px;
        }
        
        /* 密码对话框 */
        .password-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1002;
        }
        
        .password-dialog.active {
            display: flex;
        }
        
        .password-content {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .password-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .password-text {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.5;
        }
        
        .password-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            letter-spacing: 2px;
        }
        
        .password-input.error {
            border-color: #ff5252;
            background-color: #fff5f5;
        }
        
        .password-error {
            color: #ff5252;
            font-size: 14px;
            margin-bottom: 15px;
            min-height: 20px;
        }
        
        .password-success {
            color: #4CAF50;
            font-size: 14px;
            margin-bottom: 15px;
            min-height: 20px;
        }
        
        .password-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .password-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            min-width: 100px;
        }
        
        .password-btn.confirm {
            background-color: #0078d4;
            color: white;
        }
        
        .password-btn.cancel {
            background-color: #f0f0f0;
            color: #333;
        }
        
        /* 图片查看器 */
        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }
        
        .image-viewer.active {
            display: flex;
        }
        
        .image-viewer img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        
        .image-viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: none;
            border: none;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .image-viewer-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        /* 备忘录窗口样式 */
        .notes-window {
            width: 800px;
            height: 600px;
        }
        
        .notes-content {
            padding: 20px;
            overflow-y: auto;
            height: 100%;
            background-color: #f8f4e9;
        }
        
        .note {
            background-color: #fffef7;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid #e6e1d2;
            position: relative;
        }
        
        .note.diary::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: #8b7355;
            border-radius: 2px;
        }
        
        .note.todo::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: #6d8a7d;
            border-radius: 2px;
        }
        
        .note.recycle::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: #a67c52;
            border-radius: 2px;
        }
        
        .note-date {
            font-size: 14px;
            color: #8b7355;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .note-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #3d3429;
        }
        
        .note-text {
            line-height: 1.6;
            color: #5a4c3c;
            margin-bottom: 10px;
        }
        
        .note-text p {
            margin-bottom: 8px;
        }
        
        .todo-list {
            margin-top: 10px;
        }
        
        .todo-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            padding: 6px 0;
        }
        
        .todo-checkbox {
            margin-right: 10px;
            width: 16px;
            height: 16px;
            cursor: default;
            accent-color: #8b7355;
        }
        
        .todo-text {
            flex: 1;
            color: #5a4c3c;
            font-size: 14px;
        }
        
        .todo-text.completed {
            text-decoration: line-through;
            color: #9c8e7c;
        }
        
        .todo-list-title {
            font-weight: 600;
            margin-top: 15px;
            margin-bottom: 10px;
            color: #3d3429;
            font-size: 15px;
        }
        
        /* 备忘录工具栏 */
        .notes-toolbar {
            padding: 15px 20px;
            background-color: #fffef7;
            border-bottom: 1px solid #e6e1d2;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notes-categories {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 0 auto;
        }
        
        .category-btn {
            padding: 8px 16px;
            background-color: transparent;
            color: #5a4c3c;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            position: relative;
        }
        
        .category-btn:hover {
            background-color: #f0ede4;
        }
        
        .category-btn.active {
            background-color: #e9e2d6;
            color: #3d3429;
            box-shadow: inset 0 0 0 1px #d6cdbc;
        }
        
        .category-count {
            background-color: #8b7355;
            color: white;
            font-size: 11px;
            padding: 1px 6px;
            border-radius: 10px;
            margin-left: 3px;
            font-weight: normal;
        }
        
        /* 桌面时钟 - 扩大字体 */
        .desktop-clock {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 5;
            color: white;
            text-align: right;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
        }
        
        .desktop-time {
            font-size: 44px; /* 从32px扩大到44px */
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .desktop-date {
            font-size: 16px; /* 从14px扩大到16px */
            opacity: 0.9;
            margin-top: 5px;
        }
        
        /* 聊天软件通知 */
        .chat-notification {
            position: absolute;
            bottom: 60px;
            right: 20px;
            background-color: rgba(32, 32, 32, 0.95);
            border-radius: 8px;
            padding: 20px;
            width: 350px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 99;
            backdrop-filter: blur(10px);
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        
        .chat-notification.active {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .notification-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-weight: 600;
        }
        
        .notification-title i {
            color: #4CAF50;
            font-size: 18px;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: #aaa;
            font-size: 18px;
            cursor: pointer;
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .notification-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .notification-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .notification-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .notification-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .notification-btn.confirm {
            background-color: #4CAF50;
            color: white;
        }
        
        .notification-btn.confirm:hover {
            background-color: #3d8b40;
        }
        
        .notification-btn.close {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .notification-btn.close:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body>
    <!-- 桌面背景 -->
    <div class="desktop-background" id="desktopBackground"></div>
    
    <!-- 桌面时钟 -->
    <div class="desktop-clock">
        <div class="desktop-time" id="desktopTime">00:00:00</div>
        <div class="desktop-date" id="desktopDate">2023年10月15日 星期日</div>
    </div>
    
    <!-- 桌面图标 - 顺序已调整 -->
    <div class="desktop-icons">
        <!-- 聊天软件 - 绿色图标 -->
        <div class="desktop-icon" id="chatIcon" onclick="openChatApplication()">
            <div class="icon-img" style="background-color: #4CAF50;">
                <i class="fas fa-comment-dots"></i>
            </div>
            <div class="icon-label">聊天软件</div>
        </div>
        
        <!-- 论坛 - 红色图标 -->
        <div class="desktop-icon" id="forumIcon" onclick="openApplication('forum')">
            <div class="icon-img" style="background-color: #FF5252;">
                <i class="fas fa-comments"></i>
            </div>
            <div class="icon-label">怪谈论坛</div>
        </div>
        
        <!-- 备忘录 - 橙色图标 -->
        <div class="desktop-icon" id="notesIcon" onclick="toggleWindow('notesWindow')">
            <div class="icon-img" style="background-color: #FF9800;">
                <i class="fas fa-sticky-note"></i>
            </div>
            <div class="icon-label">备忘录</div>
        </div>
        
        <!-- 文件夹 - 蓝色图标 -->
        <div class="desktop-icon" id="folderIcon" onclick="openFolder()">
            <div class="icon-img" style="background-color: #2196F3;">
                <i class="fas fa-folder"></i>
            </div>
            <div class="icon-label">文件夹</div>
        </div>
    </div>
    
    <!-- 备忘录窗口 -->
    <div class="app-window notes-window" id="notesWindow">
        <div class="app-window-header">
            <div class="app-window-title">备忘录</div>
            <div class="app-window-controls">
                <div class="window-control-btn minimize" onclick="minimizeWindow('notesWindow')"></div>
                <div class="window-control-btn maximize" onclick="maximizeWindow('notesWindow')"></div>
                <div class="window-control-btn close" onclick="closeWindow('notesWindow')"></div>
            </div>
        </div>
        
        <!-- 备忘录工具栏 -->
        <div class="notes-toolbar">
            <div class="notes-categories">
                <button class="category-btn active" data-category="diary" onclick="switchCategory('diary')">
                    <i class="fas fa-book"></i>
                    个人日记
                    <span class="category-count" id="diaryCount">(5)</span>
                </button>
                <button class="category-btn" data-category="todo" onclick="switchCategory('todo')">
                    <i class="fas fa-tasks"></i>
                    待办事项
                    <span class="category-count" id="todoCount">(2)</span>
                </button>
                <button class="category-btn" data-category="recycle" onclick="switchCategory('recycle')">
                    <i class="fas fa-trash-alt"></i>
                    回收站
                    <span class="category-count" id="recycleCount">(3)</span>
                </button>
            </div>
        </div>
        
        <!-- 备忘录内容 -->
        <div class="notes-content" id="notesContent">
            <!-- 笔记会动态加载 -->
        </div>
    </div>
    
    <!-- 文件夹窗口 -->
    <div class="app-window folder-window" id="folderWindow">
        <div class="app-window-header">
            <div class="app-window-title">文件夹</div>
            <div class="app-window-controls">
                <div class="window-control-btn minimize" onclick="minimizeWindow('folderWindow')"></div>
                <div class="window-control-btn maximize" onclick="maximizeWindow('folderWindow')"></div>
                <div class="window-control-btn close" onclick="closeWindow('folderWindow')"></div>
            </div>
        </div>
        <div class="app-window-content folder-content">
            <!-- PDF文档 -->
            <div class="folder-item" onclick="openApplication('pdf')">
                <div class="folder-icon" style="color: #FF5252;">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="folder-item-name">经文.pdf</div>
            </div>
            
            <!-- HTML文档 -->
            <div class="folder-item" onclick="openApplication('html')">
                <div class="folder-icon" style="color: #E34F26;">
                    <i class="fas fa-file-code"></i>
                </div>
                <div class="folder-item-name">旅游攻略.html</div>
            </div>
            
            <!-- 图片 -->
            <div class="folder-item" onclick="openImage()">
                <div class="folder-icon" style="color: #4CAF50;">
                    <i class="fas fa-file-image"></i>
                </div>
                <div class="folder-item-name">生日礼物.jpg</div>
            </div>
        </div>
    </div>
    
    <!-- 密码对话框 -->
    <div class="password-dialog" id="passwordDialog">
        <div class="password-content">
            <div class="password-title">请输入密码</div>
            <div class="password-text">此文件夹受密码保护，请输入密码以访问。</div>
            <input type="password" class="password-input" id="passwordInput" placeholder="输入密码" maxlength="20">
            <div class="password-error" id="passwordError"></div>
            <div class="password-success" id="passwordSuccess"></div>
            <div class="password-buttons">
                <button class="password-btn confirm" onclick="checkPassword()">确定</button>
                <button class="password-btn cancel" onclick="closePasswordDialog()">取消</button>
            </div>
        </div>
    </div>
    
    <!-- 图片查看器 -->
    <div class="image-viewer" id="imageViewer">
        <button class="image-viewer-close" onclick="closeImageViewer()">
            <i class="fas fa-times"></i>
        </button>
        <img src="https://img.remit.ee/api/file/BQACAgUAAyEGAASHRsPbAAEQaR1pefbAjUL-EwhbWp9gh0cJQUOBngACYx4AAiZHyVdOLP5_VTM2ajgE.png" alt="BQACAgUAAyEGAASHRsPbAAEQaR1pefbAjUL-EwhbWp9gh0cJQUOBngACYx4AAiZHyVdOLP5_VTM2ajgE.png" />
    </div>
    
    <!-- 聊天软件通知 -->
    <div class="chat-notification" id="chatNotification">
        <div class="notification-header">
            <div class="notification-title">
                <i class="fas fa-comment-dots"></i>
                聊天软件通知
            </div>
            <button class="notification-close" onclick="closeChatNotification()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-content">
            您有新的未读消息，请及时查看。
        </div>
        <div class="notification-buttons">
            <button class="notification-btn close" onclick="closeChatNotification()">稍后</button>
            <button class="notification-btn confirm" onclick="openChatApplication()">打开聊天</button>
        </div>
    </div>
    
    <!-- 状态栏 -->
    <div class="taskbar">
        <div class="start-menu">
            <div class="power-btn" id="powerBtn" onclick="toggleShutdownMenu()">
                <i class="fas fa-power-off"></i>
            </div>
            <div class="shutdown-menu" id="shutdownMenu">
                <div class="shutdown-option" onclick="shutdown()">
                    <i class="fas fa-power-off"></i>
                    <span>关机</span>
                </div>
                <div class="shutdown-option" onclick="restart()">
                    <i class="fas fa-redo"></i>
                    <span>重启</span>
                </div>
                <div class="shutdown-option" onclick="sleep()">
                    <i class="fas fa-moon"></i>
                    <span>睡眠</span>
                </div>
            </div>
        </div>
        
        <div class="system-tray">
            <!-- 新增的聊天图标 -->
            <div class="tray-icon">
                <i class="fas fa-comment-dots" style="color: #4CAF50;"></i>
            </div>
            
            <!-- WiFi图标 -->
            <div class="tray-icon">
                <i class="fas fa-wifi"></i>
                <span>已连接</span>
            </div>
            
            <div class="tray-icon">
                <i class="fas fa-volume-up"></i>
                <span>65%</span>
            </div>
            <div class="tray-icon">
                <i class="fas fa-battery-three-quarters"></i>
                <span>78%</span>
            </div>
            <div class="time-display" id="timeDisplay">00:00</div>
            <div class="time-display" id="dateDisplay">2023/10/15</div>
        </div>
    </div>
    
    <!-- 电源确认对话框 -->
    <div class="shutdown-dialog" id="shutdownDialog">
        <div class="dialog-content">
            <div class="dialog-title">关机</div>
            <div class="dialog-text">您确定要关机吗？所有未保存的工作将会丢失。</div>
            <div class="dialog-buttons">
                <button class="dialog-btn confirm" onclick="confirmShutdown()">关机</button>
                <button class="dialog-btn cancel" onclick="cancelShutdown()">取消</button>
            </div>
        </div>
    </div>
    
    <script>
        // 笔记数据
        let currentCategory = 'diary'; // 当前选中的分类
        
        // 日记数据
        const diaryNotes = [
            {
                id: 1,
                category: 'diary',
                date: "半个月前",
                title: "",
                content: "又头晕 特别是傍晚 睡不着 一直做怪梦 去医院查不出来 室友说我是不是中邪了 也许真的该去论坛问问"
            },
            {
                id: 2,
                category: 'diary',
                date: "三个月前",
                title: "",
                content: "今天在路上晕倒了，被室友送去医院。没医保，检查开药花了好多钱……\n\n好想找妈妈哭，但还是忍住了。\n\n妈妈已经很辛苦，妹妹又要高三了，她成绩好，一定能考上好大学。我不能打扰她们。"
            },
            {
                id: 3,
                category: 'diary',
                date: "半年前",
                title: "",
                content: "终于租到合适的房子了！最近唯一的好消息。室友是南方人，性格超好，居然也喜欢看恐怖故事。\n\n而且我们俩都是 03 年出生的，好巧。\n\n希望接下来能顺利一点。"
            },
            {
                id: 4,
                category: 'diary',
                date: "九个月前",
                title: "",
                content: "毕业了。\n\n工作好难找，文科生真的没出路吗？面试了几家，工资都只有三五千……好想快点赚钱，帮妈妈分担一点。\n\n怎么办啊。"
            },
            {
                id: 5,
                category: 'diary',
                date: "一年前",
                title: "",
                content: "冬月二十，晚上十点。过了学生时代最后一个生日，和朋友吃饭聊天，特别开心。"
            }
        ];
        
        // 待办事项数据
        const todoNotes = [
            {
                id: 6,
                category: 'todo',
                date: "",
                title: "未命名二",
                todos: [
                    { id: 1, text: "发帖求助", completed: true },
                    { id: 2, text: "买车票", completed: true },
                    { id: 3, text: "活下去", completed: false }
                ]
            },
            {
                id: 7,
                category: 'todo',
                date: "",
                title: "未命名一",
                todos: [
                    { id: 1, text: "工作面试", completed: true },
                    { id: 2, text: "在公司附近租房", completed: true },
                    { id: 3, text: "室友生日 10月6日", completed: true },
                    { id: 4, text: "给妈妈转账", completed: true },
                    { id: 5, text: "回家", completed: false }
                ]
            }
        ];
        
        // 回收站数据
        const recycleNotes = [
            {
                id: 8,
                category: 'recycle',
                date: "一周前",
                title: "",
                content: "我没事我没事我没事我没事我没事我没事"
            },
            {
                id: 9,
                category: 'recycle',
                date: "一个月前",
                title: "",
                content: "最近总觉得有人跟着我。不是明显的那种，就是……背后发凉，一回头又什么都没有。\n\n家里东西也好像会自己动。钥匙明明放茶几，醒来却在书房。冰箱里的牛奶变成了我没买过的牌子，室友却说是我买的。\n\n是我记错了吗……"
            },
            {
                id: 10,
                category: 'recycle',
                date: "半年前",
                title: "",
                content: "之前在微博随便发了个求助，竟然收到了\"怪谈论坛\"的邀请码。里面氛围好邪乎，注册还要真名和生辰八字，有点吓人又有点带感。\n\n把密码记在这里吧：wyynlzdq，免得忘了。"
            }
        ];
        
        // 随机桌面背景
        const backgrounds = [
            'https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80',
            'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80',
            'https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80',
            'https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80',
            'https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80'
        ];
        
        // 检查文件夹解锁状态
        function checkFolderUnlocked() {
            return localStorage.getItem('folderUnlocked') === 'true';
        }
        
        // 设置文件夹解锁状态
        function setFolderUnlocked() {
            localStorage.setItem('folderUnlocked', 'true');
        }
        
        // 打开文件夹
        function openFolder() {
            if (checkFolderUnlocked()) {
                // 已经解锁，直接打开
                toggleWindow('folderWindow');
            } else {
                // 需要输入密码
                showPasswordDialog();
            }
        }
        
        // 设置随机桌面背景
        function setRandomBackground() {
            const randomIndex = Math.floor(Math.random() * backgrounds.length);
            document.getElementById('desktopBackground').style.backgroundImage = `url('${backgrounds[randomIndex]}')`;
        }
        
        // 更新时间显示（包括桌面时钟和状态栏）
        function updateTime() {
            // 初始游戏时间：2026年2月20日18:00
            const initialGameTime = new Date(2026, 1, 20, 18, 0, 0);
            // 游戏时间上限：2026年2月20日23:30
            const maxGameTime = new Date(2026, 1, 20, 23, 30, 0);
            
            // 从localStorage获取游戏开始时间
            let gameStartTime = localStorage.getItem('gameStartTime');
            if (!gameStartTime) {
                // 首次登录，设置游戏开始时间为当前真实时间
                gameStartTime = new Date().toISOString();
                localStorage.setItem('gameStartTime', gameStartTime);
            }
            
            // 计算游戏运行时间（毫秒）
            const realElapsedTime = Date.now() - new Date(gameStartTime).getTime();
            
            // 计算当前游戏时间
            let currentGameTime = new Date(initialGameTime.getTime() + realElapsedTime);
            
            // 确保游戏时间不超过上限
            if (currentGameTime > maxGameTime) {
                currentGameTime = maxGameTime;
            }
            
            // 中文星期
            const weekdays = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
            
            // 格式化时间
            const hours = String(currentGameTime.getHours()).padStart(2, '0');
            const minutes = String(currentGameTime.getMinutes()).padStart(2, '0');
            const seconds = String(currentGameTime.getSeconds()).padStart(2, '0');
            
            // 格式化日期
            const year = currentGameTime.getFullYear();
            const month = String(currentGameTime.getMonth() + 1).padStart(2, '0');
            const day = String(currentGameTime.getDate()).padStart(2, '0');
            const weekday = weekdays[currentGameTime.getDay()];
            
            // 更新桌面时钟显示
            document.getElementById('desktopTime').textContent = `${hours}:${minutes}:${seconds}`;
            document.getElementById('desktopDate').textContent = `${year}年${month}月${day}日 ${weekday}`;
            
            // 更新状态栏显示
            document.getElementById('timeDisplay').textContent = `${hours}:${minutes}`;
            document.getElementById('dateDisplay').textContent = `${year}/${month}/${day}`;
        }
        
        // 打开应用程序
        function openApplication(app) {
            let url;
            
            switch(app) {
                case 'forum':
                    url = 'forum.html';
                    // 在新标签页中打开论坛
                    window.open(url, '_blank');
                    return;
                case 'pdf':
                    url = 'wenjian-jingwen.html';
                    window.open(url, '_blank');
                    return;
                case 'html':
                    url = 'wenjian-lvyou.html';
                    window.open(url, '_blank');
                    return;
                default:
                    return;
            }
        }
        
        // 打开聊天软件
        function openChatApplication() {
            const url = 'chat.html';
            // 在新标签页中打开聊天
            window.open(url, '_blank');
            
            // 关闭通知
            closeChatNotification();
            
            // 标记消息为已读
            localStorage.setItem('chatMessageRead', 'true');
        }
        
        // 切换窗口显示/隐藏
        function toggleWindow(windowId) {
            const windowElement = document.getElementById(windowId);
            const allWindows = document.querySelectorAll('.app-window');
            
            // 如果点击的窗口已经显示，则隐藏它
            if (windowElement.classList.contains('active')) {
                windowElement.classList.remove('active');
            } else {
                // 隐藏所有其他窗口
                allWindows.forEach(win => {
                    win.classList.remove('active');
                });
                
                // 显示点击的窗口
                windowElement.classList.add('active');
                
                // 如果是备忘录窗口，加载笔记
                if (windowId === 'notesWindow') {
                    loadNotes();
                }
            }
        }
        
        // 关闭窗口
        function closeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
        }
        
        // 最小化窗口（简化处理，直接关闭）
        function minimizeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
        }
        
        // 最大化窗口（简化处理，切换一个类）
        function maximizeWindow(windowId) {
            const windowElement = document.getElementById(windowId);
            windowElement.classList.toggle('maximized');
            
            if (windowElement.classList.contains('maximized')) {
                windowElement.style.width = '95%';
                windowElement.style.height = '90%';
                windowElement.style.top = '20px';
                windowElement.style.left = '2.5%';
                windowElement.style.transform = 'none';
            } else {
                // 恢复默认尺寸和居中
                windowElement.style.width = '';
                windowElement.style.height = '';
                windowElement.style.top = '50%';
                windowElement.style.left = '50%';
                windowElement.style.transform = 'translate(-50%, -50%)';
            }
        }
        
        // 打开图片查看器
        function openImage() {
            document.getElementById('imageViewer').classList.add('active');
        }
        
        // 关闭图片查看器
        function closeImageViewer() {
            document.getElementById('imageViewer').classList.remove('active');
        }
        
        // 显示密码对话框
        function showPasswordDialog() {
            document.getElementById('passwordDialog').classList.add('active');
            document.getElementById('passwordInput').focus();
            document.getElementById('passwordError').textContent = '';
            document.getElementById('passwordSuccess').textContent = '';
            document.getElementById('passwordInput').classList.remove('error');
        }
        
        // 关闭密码对话框
        function closePasswordDialog() {
            document.getElementById('passwordDialog').classList.remove('active');
            document.getElementById('passwordInput').value = '';
        }
        
        // 检查密码
        function checkPassword() {
            const passwordInput = document.getElementById('passwordInput');
            const passwordError = document.getElementById('passwordError');
            const passwordSuccess = document.getElementById('passwordSuccess');
            const inputValue = passwordInput.value.trim();
            
            // 正确密码：yxzyddx
            if (inputValue === 'yxzyddx') {
                // 密码正确
                passwordSuccess.textContent = '密码正确！文件夹已打开。';
                passwordError.textContent = '';
                passwordInput.classList.remove('error');
                
                // 保存解锁状态到localStorage
                setFolderUnlocked();
                
                // 延迟关闭对话框并打开文件夹
                setTimeout(() => {
                    closePasswordDialog();
                    toggleWindow('folderWindow');
                }, 1500);
            } else {
                // 密码错误
                passwordInput.classList.add('error');
                passwordError.textContent = '密码错误，请重试';
                passwordSuccess.textContent = '';
                passwordInput.value = '';
                passwordInput.focus();
                
                // 添加振动效果
                passwordInput.style.transform = 'translateX(-5px)';
                setTimeout(() => {
                    passwordInput.style.transform = 'translateX(5px)';
                    setTimeout(() => {
                        passwordInput.style.transform = 'translateX(0)';
                    }, 50);
                }, 50);
            }
        }
        
        // 按Enter键提交密码
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });
        
        // 显示聊天软件通知
        function showChatNotification() {
            // 检查是否已经阅读过消息
            if (localStorage.getItem('chatMessageRead') !== 'true') {
                // 延迟显示通知，让页面完全加载
                setTimeout(() => {
                    document.getElementById('chatNotification').classList.add('active');
                }, 1000);
            }
        }
        
        // 关闭聊天软件通知
        function closeChatNotification() {
            document.getElementById('chatNotification').classList.remove('active');
        }
        
        // 加载备忘录笔记
        function loadNotes() {
            // 更新分类计数
            updateCategoryCounts();
            
            // 渲染笔记
            renderNotes();
        }
        
        // 更新分类计数
        function updateCategoryCounts() {
            const diaryCount = diaryNotes.length;
            const todoCount = todoNotes.length;
            const recycleCount = recycleNotes.length;
            
            document.getElementById('diaryCount').textContent = `(${diaryCount})`;
            document.getElementById('todoCount').textContent = `(${todoCount})`;
            document.getElementById('recycleCount').textContent = `(${recycleCount})`;
        }
        
        // 切换分类
        function switchCategory(category) {
            // 更新当前分类
            currentCategory = category;
            
            // 更新按钮状态
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === category) {
                    btn.classList.add('active');
                }
            });
            
            // 重新渲染笔记
            renderNotes();
        }
        
        // 渲染笔记
        function renderNotes() {
            const notesContent = document.getElementById('notesContent');
            
            // 过滤当前分类的笔记
            let filteredNotes = [];
            
            switch(currentCategory) {
                case 'diary':
                    filteredNotes = diaryNotes;
                    break;
                case 'todo':
                    filteredNotes = todoNotes;
                    break;
                case 'recycle':
                    filteredNotes = recycleNotes;
                    break;
            }
            
            if (filteredNotes.length === 0) {
                // 空状态
                let emptyText = "";
                switch(currentCategory) {
                    case 'diary':
                        emptyText = "暂无日记";
                        break;
                    case 'todo':
                        emptyText = "暂无待办事项";
                        break;
                    case 'recycle':
                        emptyText = "回收站为空";
                        break;
                }
                
                notesContent.innerHTML = `
                    <div style="text-align: center; padding: 80px 20px; color: #9c8e7c;">
                        <i class="fas fa-sticky-note" style="font-size: 48px; margin-bottom: 20px; color: #d6cdbc;"></i>
                        <p>${emptyText}</p>
                    </div>
                `;
                return;
            }
            
            notesContent.innerHTML = '';
            
            // 根据分类渲染不同的内容
            if (currentCategory === 'todo') {
                // 待办事项的渲染逻辑
                filteredNotes.forEach(note => {
                    const noteElement = document.createElement('div');
                    noteElement.className = `note todo`;
                    noteElement.dataset.id = note.id;
                    
                    let todoHtml = '';
                    
                    // 添加待办事项列表
                    if (note.todos && note.todos.length > 0) {
                        note.todos.forEach(todo => {
                            todoHtml += `
                                <div class="todo-item">
                                    <input type="checkbox" class="todo-checkbox" ${todo.completed ? 'checked' : ''} disabled>
                                    <span class="todo-text ${todo.completed ? 'completed' : ''}">${todo.text}</span>
                                </div>
                            `;
                        });
                    }
                    
                    noteElement.innerHTML = `
                        <div class="note-title">${note.title}</div>
                        <div class="todo-list">
                            ${todoHtml}
                        </div>
                    `;
                    
                    notesContent.appendChild(noteElement);
                });
            } else {
                // 日记和回收站的渲染逻辑
                filteredNotes.forEach(note => {
                    const noteElement = document.createElement('div');
                    noteElement.className = `note ${currentCategory}`;
                    noteElement.dataset.id = note.id;
                    
                    let noteContent = note.content.split('\n').map(p => p ? `<p>${p}</p>` : '').join('');
                    
                    noteElement.innerHTML = `
                        <div class="note-date">
                            <i class="far fa-calendar"></i>
                            ${note.date}
                        </div>
                        <div class="note-text">${noteContent}</div>
                    `;
                    
                    notesContent.appendChild(noteElement);
                });
            }
        }
        
        // 电源菜单功能
        function toggleShutdownMenu() {
            const menu = document.getElementById('shutdownMenu');
            menu.classList.toggle('show');
        }
        
        // 点击页面其他地方关闭电源菜单
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('shutdownMenu');
            const powerBtn = document.getElementById('powerBtn');
            
            if (!powerBtn.contains(event.target) && !menu.contains(event.target)) {
                menu.classList.remove('show');
            }
        });
        
        // 点击页面其他地方关闭窗口
        document.addEventListener('click', function(event) {
            const windows = document.querySelectorAll('.app-window');
            const desktopIcons = document.querySelector('.desktop-icons');
            
            // 如果点击的不是窗口内部，也不是桌面图标，则关闭所有窗口
            if (!event.target.closest('.app-window') && !event.target.closest('.desktop-icon')) {
                windows.forEach(window => {
                    window.classList.remove('active');
                });
            }
        });
        
        function shutdown() {
            document.getElementById('shutdownDialog').classList.add('show');
            document.getElementById('shutdownMenu').classList.remove('show');
        }
        
        function restart() {
            alert('系统将重新启动...');
            // 跳转到登录页面
            window.location.href = 'login.html';
        }
        
        function sleep() {
            alert('系统进入睡眠模式...');
            document.body.style.filter = 'brightness(0.3)';
            setTimeout(() => {
                document.body.style.filter = 'brightness(1)';
            }, 2000);
        }
        
        function confirmShutdown() {
            alert('系统正在关机...');
            // 跳转到登录页面
            window.location.href = 'login.html';
        }
        
        function cancelShutdown() {
            document.getElementById('shutdownDialog').classList.remove('show');
        }
        
        // 初始化
        window.onload = function() {
            setRandomBackground();
            updateTime();
            
            // 每秒更新时间
            setInterval(updateTime, 1000);
            
            // 显示聊天软件通知
            showChatNotification();
        };
    </script>
</body>
</html>

